<% layout('layout/boilerplate') %>
    <div class="Posts">
        <div class="mt-3 card <%= viewMode ==='light' ? " text-dark bg-light mb-3" : "text-white bg-dark mb-3" %>">
            <div class="card-body">
                <div class="d-flex w-100 justify-content-between">
                    <p class="card-text">
                        User: <a href="##">
                            <%= post.author %>
                        </a>
                    </p>
                    <small class="text-muted">5 days ago</small>
                </div>
                <div class="d-flex w-100 justify-content-between">
                    <h4 class="card-title">
                        <%= post.title %>
                    </h4>
                </div>
                <% if(post.image){ %>
                    <img class="card-img-top" src="<%= post.image %>" alt="pic">
                    <% } %>
                        <p class="card-text">
                            <%= post.text %>
                        </p>
                        <a href="/posts" class="btn btn-outline-secondary">Back to All
                            Posts</a>
                        <% if(post.author==="k6daniel" ){ %>
                            <a class="btn btn-outline-secondary" href="/posts/<%= post._id %>/edit">Edit</a>
                            <% } %>
            </div>
        </div>

        <form class="needs-validation" action="/posts/<%=post._id%>/comment" method="POST" novalidate>
            <label class="form-label" for="text">Make a Comment: </label>
            <textarea class="form-control" name="text" id="text" placeholder="What do you think about this post?"
                cols="30" rows="4" required></textarea>
            <div class="invalid-feedback">
                You need to type something to make a comment.
            </div>
            <button class="btn btn-outline-secondary my-3">Comment</button>
        </form>

        <!-- Have to add in fancy js to make edit form seamlessly appear  -->
        <!-- <h1 style="display: block" id="unwanted">I am unwanted text</h1>
    <button class="btn btn-sm btn-outline-secondary" id="button">CLICK ME TO HIDE THE TEXT</button> -->



        <% for(let comment of post.comments){ %>
            <div class="mb-3 card <%= viewMode ==='light' ? " text-dark bg-light mb-3" : "text-white bg-dark mb-3" %>">
                <div class="card-body">
                    <div class="d-flex w-100 justify-content-between">
                        <p class="card-text text-muted">
                            <a href="/USERPROFILE OR SOMETHING">
                                <%= comment.author %>
                            </a>
                        </p>
                        <small class="text-muted">5 days ago</small>
                    </div>

                    <p class="card-text">
                        <%= comment.text %>
                    </p>
                    <p class="text-muted">Likes: <%= comment.likes%>
                    </p>
                    <form action="/posts/<%=post._id%>/comment/<%= comment._id %>?_method=DELETE" method="POST">
                        <button class="btn btn-sm btn-outline-secondary">Delete Comment</button>
                    </form>
                </div>
            </div>
            <% } %>
    </div>
    <script>
        var text = document.getElementById('unwanted')
        const btn = document.getElementById('button')
        btn.addEventListener('click', () => {
            if (text.style.display == 'block') {
                text.style.display = 'none'
            } else {
                text.style.display = 'block'
            }
        })
    </script>